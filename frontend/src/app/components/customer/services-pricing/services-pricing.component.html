<div class="dashboard-container">
  <!-- Welcome Section -->
  <div class="welcome-section">
    <div class="welcome-header">
      <h1 class="welcome-title">Welcome, {{ customerName || "Customer" }}</h1>
    </div>
    <p class="welcome-description">
      View our comprehensive car wash service pricing based on your vehicle type
      and service package.
    </p>
    <button class="btn-primary" (click)="navigateToAppointment()">
      Book a Service Now
    </button>
  </div>

  <!-- Authentication Error Section -->
  <div
    *ngIf="
      (error && error.includes('authentication')) || error.includes('log in')
    "
    class="auth-error-section"
  >
    <div class="auth-error-content">
      <h2>Authentication Required</h2>
      <p>{{ error }}</p>
      <button class="btn-primary" (click)="redirectToLogin()">
        Log In Again
      </button>
    </div>
  </div>

  <!-- Services & Pricing Section -->
  <div
    *ngIf="!error || !error.includes('authentication')"
    class="services-section"
  >
    <div class="section-header">
      <h2>Service Packages & Pricing</h2>
      <p>Choose the perfect service package for your vehicle</p>
    </div>

    <!-- Service Packages Explanation -->
    <div class="packages-explanation">
      <h3>Service Package Details</h3>
      <div class="packages-grid">
        <div *ngFor="let package of servicePackages" class="package-info">
          <h4>Package {{ package.code }}</h4>
          <p>{{ package.description }}</p>
        </div>
      </div>
    </div>

    <!-- Vehicle Types Explanation -->
    <div class="vehicle-types-explanation">
      <h3>Vehicle Type Classification</h3>
      <div class="vehicle-types-grid">
        <div *ngFor="let vehicle of vehicleTypes" class="vehicle-info">
          <h4>{{ vehicle.code }}</h4>
          <p>{{ vehicle.description }}</p>
        </div>
      </div>
    </div>

    <!-- Pricing Matrix -->
    <div class="pricing-section">
      <h3>Pricing Matrix</h3>

      <!-- Loading State -->
      <div *ngIf="loading" class="loading-state">
        <div class="loading-spinner"></div>
        <p>Loading pricing information...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !loading" class="error-state">
        <p class="error-message">{{ error }}</p>
        <button class="btn-primary" (click)="loadPricingData()">
          Try Again
        </button>
      </div>

      <!-- Pricing Table -->
      <div *ngIf="!loading && !error" class="pricing-table-container">
        <div class="pricing-table">
          <table>
            <thead>
              <tr>
                <th class="vehicle-header">Vehicle Type</th>
                <th
                  *ngFor="let package of servicePackages"
                  class="package-header"
                >
                  <div class="package-title">Package {{ package.code }}</div>
                  <div class="package-desc">{{ package.description }}</div>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let vehicle of vehicleTypes" class="vehicle-row">
                <td class="vehicle-cell">
                  <div class="vehicle-code">{{ vehicle.code }}</div>
                  <div class="vehicle-desc">{{ vehicle.description }}</div>
                </td>
                <td *ngFor="let package of servicePackages" class="price-cell">
                  <div class="price-amount">
                    {{
                      formatPrice(
                        pricingMatrix[vehicle.code][package.code] || 0
                      )
                    }}
                  </div>
                  <!-- <button
                    class="btn-book-service"
                    (click)="
                      navigateToAppointmentWithPackage(
                        vehicle.code,
                        package.code
                      )
                    "
                    [disabled]="!isPriceAvailable(vehicle.code, package.code)"
                    [ngClass]="{
                      disabled: !isPriceAvailable(vehicle.code, package.code)
                    }"
                  >
                    {{
                      isPriceAvailable(vehicle.code, package.code)
                        ? "Book Now"
                        : "Unavailable"
                    }}
                  </button> -->
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Quick Booking Guide -->
      <div class="booking-guide">
        <h4 class="booking-title">How to Book</h4>
        <ol class="booking-steps">
          <li>Add a vehicle to your profile</li>
          <li>Identify your vehicle type from the classification above</li>
          <li>Choose your preferred service package</li>
          <li>Click "Book Now" for your selected combination</li>
          <li>Complete your appointment details</li>
        </ol>
      </div>
    </div>

    <!-- Booking Tips Section -->
    <div class="booking-tips-section">
      <div class="booking-tips-header">
        <svg class="tips-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z" fill="currentColor"/>
        </svg>
        <h3 class="booking-tips-title">Booking Tips</h3>
      </div>
      <div class="booking-tips-divider"></div>
      <div class="booking-tips-list">
        <div class="booking-tip-item">
          <svg class="tip-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z" fill="currentColor"/>
          </svg>
          <span class="tip-text">Book at least 30 Minutes in advance.</span>
        </div>
        <div class="booking-tips-divider-small"></div>
        <div class="booking-tip-item">
          <svg class="tip-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z" fill="currentColor"/>
          </svg>
          <span class="tip-text">Ensure your vehicle is accessible.</span>
        </div>
        <div class="booking-tips-divider-small"></div>
        <div class="booking-tip-item">
          <svg class="tip-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z" fill="currentColor"/>
          </svg>
          <span class="tip-text">Keep your phone nearby for updates.</span>
        </div>
        <div class="booking-tips-divider-small"></div>
        <div class="booking-tip-item">
          <svg class="tip-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z" fill="currentColor"/>
          </svg>
          <span class="tip-text">Payment is processed after service completion.</span>
        </div>
      </div>
    </div>
  </div>
</div>
